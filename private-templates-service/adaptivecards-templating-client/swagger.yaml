swagger: "2.0"
info:
  description: "Adaptive Cards Templating Service API definition."
  version: "1.0.0"
  title: "adaptivecards-templating-service-javascript-sdk"
  license:
    name: "Apache 2.0"
    url: "http://www.apache.org/licenses/LICENSE-2.0.html"
host: "adaptivecms.azurewebsites.net"
tags:
- name: "template"
  description: "Adaptive Cards Template"
  externalDocs:
    description: "Adaptive Cards Templating Service"
    url: "https://github.com/microsoft/adaptivecards-templates/tree/dev/private-templates-service"
- name: "user"
  description: "Adaptive Cards Templating Service users"
schemes:
- "https"
- "http"
securityDefinitions:
  bearer_auth:
    type: apiKey
    name: Authorization
    in: header
paths:
  '/template':
    get: 
      tags: 
        - "template"
      summary: "Find all templates"
      description: "Returns all public templates and owned templates"
      produces:
        - "application/json"
      responses:
        200:
          description: "successful operation"
          schema: 
            $ref: "#/definitions/TemplateList"
        400: 
          description: "No templates"
          schema: 
            $ref: "#/definitions/BaseError"
        401: 
          description: "Unauthorized user"
          schema: 
            $ref: "#/definitions/BaseError"
      parameters:
        - in: query
          name: isPublished
          type: boolean
          description: Query based on if template is published
        - in: query
          name: name
          type: string
          description: Name of template to query for
        - in: query
          name: version
          type: string
          description: Version of template
        - in: query
          name: owned
          type: boolean
          description: Display only the templates owned by the user
        - in: query
          name: sortBy
          type: string
          description: Sort templates by date created, date modified, alphabetical    
        - in: query
          name: sortOrder
          type: string
          description: Sort templates by ascending or descending order 
      security:
        - bearer_auth: []
    post: 
      tags: 
        - "template"
      summary: "Add a new template"
      description: ""
      parameters:
        - in: "body"
          name: "body"
          description: "Template object to be added"
          required: true
          schema:
            $ref: "#/definitions/TemplateJSON"
      responses:
        201: 
          description: "Template successfully created"
          schema:
            $ref: "#/definitions/ResourceCreated"
        400:
          description: "Invalid template"
          schema: 
            $ref: "#/definitions/BaseError"
        401:
          description: "Unauthorized user"
          schema: 
            $ref: "#/definitions/BaseError"
      security:
        - bearer_auth: []
  '/template/{templateId}':
    get: 
      tags: 
        - "template"
      summary: "Find template by id"
      description: "Returns a single template"
      operationId: "templateById"
      produces:
        - "application/json"
      parameters:
        - name: "templateId"
          in: "path"
          description: "ID of template to return"
          required: true
          type: string
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: '#/definitions/TemplateList'
        400:
          description: "Invalid template ID supplied"
          schema: 
            $ref: "#/definitions/BaseError"
        404:
          description: "Template not found"
          schema: 
            $ref: "#/definitions/BaseError"
        401:
          description: "Unauthorized user"
          schema: 
            $ref: "#/definitions/BaseError"
      security:
        - bearer_auth: []
    post:
      tags: 
        - "template"
      summary: "Update existing template"
      description: "Update existing template given id"
      produces:
        - "application/json"
      parameters:
        - name: "templateId"
          in: "path"
          description: "ID of template to update"
          required: true
          type: string
        - in: "body"
          name: "body"
          description: "Template object to be added"
          required: true
          schema:
            $ref: "#/definitions/TemplateJSON"
      responses:
        201: 
          description: "successful operation"
        400:
          description: "Unable to create given template"
          schema: 
            $ref: "#/definitions/BaseError"
        401:
          description: "Unauthorized user"
          schema: 
            $ref: "#/definitions/BaseError"        
      security:
        - bearer_auth: []
  '/template/{templateId}/preview':
    get:
      tags: 
        - "template"
      summary: "Get template preview"
      description: "Template preview for shareable link"
      operationId: "templatePreviewById"
      produces:
        - "application/json"
      parameters:
        - name: "templateId"
          in: "path"
          description: "ID of template to return"
          required: true
          type: string
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: '#/definitions/TemplatePreviewResponse'
        400:
          description: "Invalid template ID supplied"
          schema: 
            $ref: "#/definitions/BaseError"
        404:
          description: "Template not found"
          schema: 
            $ref: "#/definitions/BaseError"
        401:
          description: "Unauthorized user"
          schema: 
            $ref: "#/definitions/BaseError"  
      security:
        - bearer_auth: []
  '/user':
    get: 
      tags:
        - "user"
      summary: "Get user's info"
      description: "Returns user's info"
      produces:
        - "application/json"
      responses:
        200: 
          description: "successful operation"
          schema: 
            $ref: "#/definitions/UserList"
        401: 
          description: "Unauthorized user"
          schema: 
            $ref: "#/definitions/BaseError" 
      security:
        - bearer_auth: []
    delete: 
      tags: 
        - "user"
      summary: "Delete all user info"
      description: "Delete all user info and user owner templates"
      produces: 
        - "application/json"
      responses:
        204: 
          description: "successful operation"
        401: 
          description: "Unauthorized user"
          schema: 
            $ref: "#/definitions/BaseError" 
      security:
        - bearer_auth: []
definitions:
  ResourceCreated:
    type: object
    properties:
      id:
        type: string
  BaseError: 
    type: object
    properties: 
      error: 
        type: object
        properties: 
          code:
            type: string
          message:
            type: string
  TemplateList:
    type: object
    properties: 
      templates:
        type: array
        items: 
          $ref: "#/definitions/Template"
  Template:
    type: object
    properties:
      _id: 
        type: string
      name: 
        type: string
      instances:
        type: array
        items: 
          $ref: "#/definitions/TemplateInstance"
      owner: 
        type: string
      isPublished:
        type: boolean
      createdAt:
        type: string
        format: Date
      updatedAt:
        type: string
        format: Date
      publishedAt:
        type: string
        format: Date     
      tags: 
        type: array
        items:
          type: string
      isShareable:
        type: boolean
  TemplateInstance:
    type: object
    properties:
      json: 
        type: string
        format: JSON
      version: 
        type: string
  TemplateJSON:
    type: object
    properties: 
      template: 
        type: string
        format: JSON
      isPublished:
        type: boolean
      name: 
        type: string
      isShareable:
        type: boolean
      tags: 
        type: array
        items:
          type: string
  UserList:
    type: object
    properties:
      user:
        type: array
        items:
          $ref: "#/definitions/User"
  TemplatePreviewResponse:
    type: object
    properties:
      template:
        $ref: "#/definitions/TemplatePreview"
  TemplatePreview:
    type: object
    properties:
      name: 
        type: string
      json:
        type: string
        format: JSON
      owner: 
        type: string
  User: 
    type: object  
    properties:
      _id: 
        type: string
      authId: 
        type: string
      issuer:
        type: string
      team: 
        type: array
        items: 
          type: string
      org: 
        type: array
        items: 
          type: string
